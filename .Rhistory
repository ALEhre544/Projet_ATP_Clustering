library(tidyverse)
library(factoextra)
library(FactoMineR)
library(NbClust)
library(dendextend)
library(fpc)
library(devtools)
players <- read_csv("tennis_atp/atp_players.csv", col_names = FALSE)
df <- read_csv("C:/Users/Mehdi/Desktop/M2 URCA/GIT R/Tennis_data/atp_matches_2012.csv")
# CrÃ©er un tableau agrÃ©gÃ© des gagnants
df_winner <- df  %>%
group_by(winner_name) %>%
summarise(w_ace = mean(w_ace, na.rm = TRUE),
w_ht = winner_ht,
w_stIn = mean(w_1stIn, na.rm = TRUE),
w_stWon = mean(w_1stWon, na.rm = TRUE),
w_svgms = mean(w_SvGms, na.rm = TRUE),
w_bpSaved = mean(w_bpSaved, na.rm = TRUE),
w_bpFaced = mean(w_bpFaced, na.rm = TRUE),
w_min = mean(minutes, na.rm = TRUE))
df_winner <- distinct(df_winner,.keep_all = TRUE)
df %>%
select(winner_name, winner_age) -> df_w_age
df_w_age <- distinct(df_w_age,.keep_all = TRUE)
# CrÃ©er un tableau agrÃ©gÃ© des perdants
df_loser <- df  %>%
group_by(loser_name) %>%
summarise(l_ace = mean(l_ace, na.rm = TRUE),
l_ht = loser_ht,
l_stIn = mean(l_1stIn, na.rm = TRUE),
l_stWon = mean(l_1stWon, na.rm = TRUE),
l_svgms = mean(l_SvGms, na.rm = TRUE),
l_bpSaved = mean(l_bpSaved, na.rm = TRUE),
l_bpFaced = mean(l_bpFaced, na.rm = TRUE),
l_min = mean(minutes, na.rm = TRUE))
df_loser <- distinct(df_loser,.keep_all = TRUE)
df %>%
select(loser_name, loser_age) -> df_l_age
View(df_l_age)
View(df_l_age)
df_l_age <- distinct(df_l_age,.keep_all = TRUE)
# Donner le mÃªme nom du variable au "winner_name" et "loser_name"
df_loser <- rename(df_loser, player = loser_name )
df_winner <- rename(df_winner, player = winner_name)
df_w_age <- rename(df_w_age, player = winner_name )
df_l_age <- rename(df_l_age, player = loser_name )
# Jointure des tables
df_player <- full_join(df_winner, df_loser, by = "player")
df_age <- full_join(df_w_age, df_l_age, by = "player")
View(df_age)
View(df_age)
df_agee <- distinct(df_age, player)
View(df_agee)
View(df_agee)
df_agee <- distinct(df_age, player, keep_all = TRUE)
View(df_agee)
View(df_agee)
View(df_age)
View(df_age)
df_agee <- distinct(df_age, c(player,winner_age))
df_agee <- group_by(player)
df_agee <- group_by(df_age$player)
df_agee <- df_age %>%
group_by(player) %>%
summarize(age = winner_age)
View(df_agee)
View(df_agee)
View(df_age)
View(df_age)
df_agee <- df_age %>%
group_by(player) %>%
summarize(age = max(winner_age))
View(df_agee)
View(df_agee)
df_agee <- df_age %>%
group_by(player) %>%
summarize(age1 = max(winner_age),
age2 = max(loser_age))
View(df_agee)
View(df_agee)
df_agee <- df_age %>%
group_by(player) %>%
summarize(age1 = max(winner_age),
age2 = max(loser_age)) %>%
mutate(age= max(age1, age2))
df_agee <- df_age %>%
group_by(player) %>%
summarize(age1 = max(winner_age),
age2 = max(loser_age)) %>%
mutate(age= max(age1, age2,na.rm = TRUE))
df_agee <- df_age %>%
group_by(player) %>%
summarize(age1 = max(winner_age),
age2 = max(loser_age)) %>%
rowwise() %>%
mutate(age= max(age1, age2,na.rm = TRUE))
View(df_agee)
View(df_agee)
df_agee <- df_age %>%
group_by(player) %>%
summarize(age1 = max(winner_age),
age2 = max(loser_age)) %>%
rowwise() %>%
mutate(age= max(age1, age2,na.rm = TRUE))%>%
select(player,age)
df_age <- df_age %>%
group_by(player) %>%
summarize(age1 = max(winner_age),
age2 = max(loser_age)) %>%
rowwise() %>%
mutate(age= max(age1, age2,na.rm = TRUE))%>%
select(player,age)
