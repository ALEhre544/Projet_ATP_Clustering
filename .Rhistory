library(tidyverse)
players <- read_csv("C:/Users/Mehdi/Desktop/M2 URCA/GIT R/Tennis_data/atp_players.csv", col_names = FALSE)
names(players) <- c("id", "firstname", "lastname", "hand", "birthday", "nat")
df <- read_csv("C:/Users/Mehdi/Desktop/M2 URCA/GIT R/Tennis_data/atp_matches_2012.csv")
View(df)
View(df)
w_bpFaced) %>%
group_by(winner_name) %>%
summarise(ace = mean(w_ace, na.rm = TRUE),
dfault = mean(w_df, na.rm = TRUE),
svpt = mean(w_1stIn, na.rm = TRUE),
stwon = mean(w_1stWon, na.rm = TRUE),
ndwon = mean(w_2ndWon, na.rm = TRUE),
svgms = mean(w_SvGms, na.rm = TRUE),
bpsaved = mean(w_bpSaved, na.rm = TRUE),
bpfaced = mean(w_bpFaced, na.rm = TRUE))
df  %>%
select(winner_name,w_ace, w_df, w_svpt, w_1stIn, w_1stWon, w_2ndWon, w_SvGms, w_bpSaved
w_bpFaced) %>%
group_by(winner_name) %>%
summarise(ace = mean(w_ace, na.rm = TRUE),
dfault = mean(w_df, na.rm = TRUE),
svpt = mean(w_1stIn, na.rm = TRUE),
stwon = mean(w_1stWon, na.rm = TRUE),
ndwon = mean(w_2ndWon, na.rm = TRUE),
svgms = mean(w_SvGms, na.rm = TRUE),
bpsaved = mean(w_bpSaved, na.rm = TRUE),
bpfaced = mean(w_bpFaced, na.rm = TRUE))
w_bpFaced) %>%
group_by(winner_name) %>%
summarise(ace = mean(w_ace, na.rm = TRUE),
dfault = mean(w_df, na.rm = TRUE),
svpt = mean(w_1stIn, na.rm = TRUE),
stwon = mean(w_1stWon, na.rm = TRUE),
ndwon = mean(w_2ndWon, na.rm = TRUE),
svgms = mean(w_SvGms, na.rm = TRUE),
bpsaved = mean(w_bpSaved, na.rm = TRUE),
bpfaced = mean(w_bpFaced, na.rm = TRUE))
df  %>%
group_by(winner_name) %>%
summarise(ace = mean(w_ace, na.rm = TRUE),
dfault = mean(w_df, na.rm = TRUE),
svpt = mean(w_1stIn, na.rm = TRUE),
stwon = mean(w_1stWon, na.rm = TRUE),
ndwon = mean(w_2ndWon, na.rm = TRUE),
svgms = mean(w_SvGms, na.rm = TRUE),
bpsaved = mean(w_bpSaved, na.rm = TRUE),
bpfaced = mean(w_bpFaced, na.rm = TRUE))
dff <- df  %>%
group_by(winner_name) %>%
summarise(ace = mean(w_ace, na.rm = TRUE),
dfault = mean(w_df, na.rm = TRUE),
svpt = mean(w_1stIn, na.rm = TRUE),
stwon = mean(w_1stWon, na.rm = TRUE),
ndwon = mean(w_2ndWon, na.rm = TRUE),
svgms = mean(w_SvGms, na.rm = TRUE),
bpsaved = mean(w_bpSaved, na.rm = TRUE),
bpfaced = mean(w_bpFaced, na.rm = TRUE))
View(dff)
View(dff)
df1 <-  filter(df, winner_name = "Rafael Nadal")
library(dplyr)
df1 <-  filter(df, winner_name = "Rafael Nadal")
df1 <-  filter(df, winner_name == "Rafael Nadal")
View(df1)
View(df1)
dff <- df  %>%
group_by(winner_name, winner_ht) %>%
summarise(ace = mean(w_ace, na.rm = TRUE),
dfault = mean(w_df, na.rm = TRUE),
svpt = mean(w_1stIn, na.rm = TRUE),
stwon = mean(w_1stWon, na.rm = TRUE),
ndwon = mean(w_2ndWon, na.rm = TRUE),
svgms = mean(w_SvGms, na.rm = TRUE),
bpsaved = mean(w_bpSaved, na.rm = TRUE),
bpfaced = mean(w_bpFaced, na.rm = TRUE),
min = mean(minutes, na.rm = TRUE) )
dg <- df %>%
mutate(ace = l_ace + w_ace)
View(dg)
View(dg)
dg <- df %>%
mutate(ace = l_ace + w_ace,
dblef = w_df + l_df,
svpt = w_svpt + l_svpt,
stIn = w_1stIn + l_1stIn,
stWon = w_1stWon + l_1stWon,
svgms = w_SvGms + l_SvGms,
bpsaved = w_bpsaved + l_bpSaved,
bpfaced = w_bpFaced + l_bpFaced
)
dg <- df %>%
mutate(ace = l_ace + w_ace,
dblef = w_df + l_df,
svpt = w_svpt + l_svpt,
stIn = w_1stIn + l_1stIn,
stWon = w_1stWon + l_1stWon,
svgms = w_SvGms + l_SvGms,
bpsaved = w_bpSaved + l_bpSaved,
bpfaced = w_bpFaced + l_bpFaced
)
View(dg)
View(dg)
View(df)
View(df)
dg <- df %>%
mutate(ace = l_ace + w_ace,
dblef = w_df + l_df,
svpt = w_svpt + l_svpt,
stIn = w_1stIn + l_1stIn,
stWon = w_1stWon + l_1stWon,
svgms = w_SvGms + l_SvGms,
bpsaved = w_bpSaved + l_bpSaved,
bpfaced = w_bpFaced + l_bpFaced,
ht = winner_ht + loser_ht
)
View(dg)
View(dg)
dg <- df %>%
mutate(ace = l_ace + w_ace,
dblef = w_df + l_df,
svpt = w_svpt + l_svpt,
stIn = w_1stIn + l_1stIn,
stWon = w_1stWon + l_1stWon,
ndWon = w_2ndWon + l_2ndWon,
svgms = w_SvGms + l_SvGms,
bpsaved = w_bpSaved + l_bpSaved,
bpfaced = w_bpFaced + l_bpFaced,
ht = winner_ht + loser_ht
)
player = mutate(p = winner_name + loser_name)
player = mutate(df,p = winner_name + loser_name)
filter(df, winner_name == NA)
player = mutate(df, p = case_when(winner_name == NA ~ loser_name,
loser_name == NA ~ winner_name))
View(player)
View(player)
player = mutate(df, p = case_when(w_ace == NA ~ loser_name,
l_ace == NA ~ winner_name))
View(player)
View(player)
View(player)
df_winner <-  select(df, winner_name, w_ace,
dblef = w_df, w_svpt, w_1stIn,  w_1stWon,
w_2ndWon, w_SvGms, w_bpSaved, w_bpFaced, winner_ht, minutes)
View(df_winner)
View(df_winner)
df_winner <-  select(df, winner_name, w_ace,
w_df, w_svpt, w_1stIn,  w_1stWon,
w_2ndWon, w_SvGms, w_bpSaved, w_bpFaced, winner_ht, minutes)
df_loser <-  select(df, loser_name, l_ace,
l_df, l_svpt, l_1stIn,  l_1stWon,
l_2ndWon, l_SvGms, l_bpSaved, l_bpFaced, loser_ht, minutes)
View(df_loser)
View(df_loser)
?full_join
df_players = full_join(df_winner, df_loser)
View(df_players)
View(df_players)
df_winner <-  select(df, winner_name, w_ace,
w_df, w_svpt, w_1stIn,  w_1stWon,
w_2ndWon, w_SvGms, w_bpSaved, w_bpFaced, winner_ht)
df_loser <-  select(df, loser_name, l_ace,
l_df, l_svpt, l_1stIn,  l_1stWon,
l_2ndWon, l_SvGms, l_bpSaved, l_bpFaced, loser_ht)
df_players = full_join(df_winner, df_loser)
?bind_cols
df_players = bind_cols(df_winner, df_loser)
View(df_players)
View(df_players)
View(dff)
View(dff)
df_winner <- df  %>%
group_by(winner_name, winner_ht) %>%
summarise(w_ace = mean(w_ace, na.rm = TRUE),
w_df = mean(w_df, na.rm = TRUE),
w_stIn = mean(w_stIn, na.rm = TRUE),
w_stWon = mean(w_stWon, na.rm = TRUE),
w_ndWon = mean(w_ndWon, na.rm = TRUE),
w_svgms = mean(w_svgms, na.rm = TRUE),
w_bpSaved = mean(w_bpSaved, na.rm = TRUE),
w_bpFaced = mean(w_bpFaced, na.rm = TRUE))
df_winner <- df  %>%
group_by(winner_name, winner_ht) %>%
summarise(w_ace = mean(w_ace, na.rm = TRUE),
w_df = mean(w_df, na.rm = TRUE),
w_stIn = mean(w_1stIn, na.rm = TRUE),
w_stWon = mean(w_1stWon, na.rm = TRUE),
w_ndWon = mean(w_2ndWon, na.rm = TRUE),
w_svgms = mean(w_svgms, na.rm = TRUE),
w_bpSaved = mean(w_bpSaved, na.rm = TRUE),
w_bpFaced = mean(w_bpFaced, na.rm = TRUE))
df_winner <- df  %>%
group_by(winner_name, winner_ht) %>%
summarise(w_ace = mean(w_ace, na.rm = TRUE),
w_df = mean(w_df, na.rm = TRUE),
w_stIn = mean(w_1stIn, na.rm = TRUE),
w_stWon = mean(w_1stWon, na.rm = TRUE),
w_ndWon = mean(w_2ndWon, na.rm = TRUE),
w_svgms = mean(w_SvGms, na.rm = TRUE),
w_bpSaved = mean(w_bpSaved, na.rm = TRUE),
w_bpFaced = mean(w_bpFaced, na.rm = TRUE))
View(df_winner)
View(df_winner)
df_loser <- df  %>%
group_by(loser_name, loser_ht) %>%
summarise(l_ace = mean(l_ace, na.rm = TRUE),
l_df = mean(l_df, na.rm = TRUE),
l_stIn = mean(l_1stIn, na.rm = TRUE),
l_stWon = mean(l_1stWon, na.rm = TRUE),
l_ndWon = mean(l_2ndWon, na.rm = TRUE),
l_svgms = mean(l_SvGms, na.rm = TRUE),
l_bpSaved = mean(l_bpSaved, na.rm = TRUE),
l_bpFaced = mean(l_bpFaced, na.rm = TRUE))
View(df_loser)
View(df_loser)
?merge
?merge
df_loser <- df  %>%
group_by(loser_name, loser_ht) %>%
summarise(l_ace = mean(l_ace, na.rm = TRUE),
l_df = mean(l_df, na.rm = TRUE),
l_stIn = mean(l_1stIn, na.rm = TRUE),
l_stWon = mean(l_1stWon, na.rm = TRUE),
l_ndWon = mean(l_2ndWon, na.rm = TRUE),
l_svgms = mean(l_SvGms, na.rm = TRUE),
l_bpSaved = mean(l_bpSaved, na.rm = TRUE),
l_bpFaced = mean(l_bpFaced, na.rm = TRUE))
View(df_loser)
View(df_loser)
?merge
